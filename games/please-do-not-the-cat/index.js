let S={canvas:{cats:[],size:[window.screen.width*1.5,window.screen.height*1.5]},econ:{auto:0,balance:1,base:1,discount:100,drain:0,interest:0,mult:100,total:0},meta:{active:!0,freeze:!1,magnitude:0,mute:!1,playthrough:1,starttime:new Date().getTime()},phys:{damping:.3,gravity:5,noise:.2,overlap:.25},skills:{bindings:{Q:null,W:null,E:null,R:null},selected:[]},story:{narrator:null,milestone:0,unlocked:[]}};const startGame=()=>{E.launch.classList.add("hidden"),S.meta.active=!0,S.meta.starttime=new Date().getTime(),S.canvas.cats.push(new Cat({coordinates:[0,0]})),registerKeys(),S.skills.selected=S.skills.selected.sort((t,e)=>t.substring(1)-e.substring(1)),S.skills.selected.length==1&&S.skills.selected[0]=="s13"?S.skills.bindings={Q:null,W:null,E:null,R:skillRegister.s13.generator({key:"R"})}:Object.keys(S.skills.bindings).forEach((t,e)=>{S.skills.bindings[t]=S.skills.selected[e]?skillRegister[S.skills.selected[e]].generator({key:t}):null}),S.story.narrator=new Narrator,updateBalance(0)},saveGame=()=>{const t=JSON.stringify(S);localStorage.setItem("mcteamster.black.savedata",t)};onbeforeunload=saveGame;const loadGame=()=>{const t=localStorage.getItem("mcteamster.black.savedata");return t?(S=JSON.parse(t),S.canvas.size=[window.screen.width*1.5,window.screen.height*1.5],S.canvas.cats=S.canvas.cats.map(e=>new Cat(e)),registerKeys(),Object.keys(S.skills.bindings).forEach(e=>{S.skills.bindings[e]?.id?S.skills.bindings[e]=skillRegister[S.skills.bindings[e].id].generator(S.skills.bindings[e]):S.skills.bindings[e]=null}),S.story.narrator=new Narrator(S.story.narrator),updateBalance(0),S.meta.active||updateLauncher(),!0):!1},resetGame=()=>{localStorage.removeItem("mcteamster.black.savedata"),onbeforeunload=void 0,location.reload()},E={body:document.body},ids=["canvas","counter","dialogue","interest","stats","pause","mute","menu","restart","clear","launch","instructions","picker","start","playthrough"];ids.forEach(t=>E[t]=document.getElementById(t));const registerKeys=()=>{let t="";["Q","W","E","R"].forEach(i=>{t+=`
      <div id="Key${i}" class="command centered column">
        <div id="Key${i}Icon" class='commandIcon'>${i}</div>
        <div id="Key${i}Effect" class='commandEffect'></div>
        <div id="Key${i}Price" class='commandPrice'></div>
      </div>
    `}),document.getElementById("commands").innerHTML=t,["KeyQ","KeyW","KeyE","KeyR"].forEach(i=>E[i]=document.getElementById(i))};registerKeys(),E.canvas.width=S.canvas.size[0],E.canvas.height=S.canvas.size[1];const ctx=E.canvas.getContext("2d");ctx.fillStyle="black";const blackCat="&#x1F408;&#x200D;&#x2B1B;",meows=Array.from({length:5},()=>new Audio("./meow.mp3")),notation=(t,e)=>{let i,n=e?"":" cats";return t==1?(i=1,n=e?"":" cat"):t>1&&t<10**6?i=t.toFixed(0):t>=10**6&&t<10**21?t>=10**18?(i=(t/10**18).toFixed(2),n=e?"E":" Exacats"):t>=10**15?(i=(t/10**15).toFixed(2),n=e?"P":" Petacats"):t>=10**12?(i=(t/10**12).toFixed(2),n=e?"T":" Teracats"):t>=10**9?(i=(t/10**9).toFixed(2),n=e?"G":" Gigacats"):(i=(t/10**6).toFixed(2),n=e?"M":" Megacats"):i=t.toPrecision(3),`${i}${n}`},updateHud=()=>{E.counter.innerHTML=S.meta.playthrough==1&&S.econ.balance==1||S.econ.balance<=0||S.econ.balance>10**100?"":`${blackCat} ${notation(S.econ.balance)}`,E.interest.innerHTML=`
    ${S.econ.interest>0?"&#x1F4C8; "+S.econ.interest.toFixed(2)+"% ps":""}
    ${S.econ.drain>0?"&nbsp;&#x1F4C9 -"+notation(S.econ.drain,!0)+" ps":""}
  `,S.econ.drain>0?E.dialogue.style.background="rgba(255, 0, 0, 0.75)":E.dialogue.style.background="rgba(0, 0, 0, 0.75)",E.stats.innerHTML=`
    ${S.econ.base>1?"&#x270B; "+notation(S.econ.base,!0):""}&nbsp;
    ${S.econ.mult>100?" &#x274E; "+(S.econ.mult>10**5?notation(S.econ.mult/100,!0):(S.econ.mult/100).toFixed(1)):""}
  `,["Q","W","E","R"].forEach(t=>{if(S.skills.bindings[t]){S.econ.balance>S.skills.bindings[t].cost*S.econ.discount/100&&S.skills.bindings[t].enable();let e="";S.skills.bindings[t].cooldown>0?(e=((S.skills.bindings[t].timestamp+S.skills.bindings[t].cooldown*S.econ.discount/100-new Date().getTime())/1e3).toFixed(0),e<=0?e="Ready":e+="s"):S.skills.bindings[t].cost>1?e=notation(S.skills.bindings[t].cost*S.econ.discount/100,!0)+"&nbsp;"+blackCat:S.skills.bindings[t].cost==0&&(e="Off"),document.getElementById(`Key${t}Icon`).innerHTML=`${S.skills.bindings[t].icon}`,document.getElementById(`Key${t}Effect`).innerHTML=`${typeof S.skills.bindings[t].effect=="function"?S.skills.bindings[t].effect():S.skills.bindings[t].effect}`,document.getElementById(`Key${t}Price`).innerHTML=`${e}`}else E[`Key${t}`].classList.add("hidden")}),E.mute.innerHTML=S.meta.mute?"&#x1F507;":"&#x1F509;"},updateLauncher=()=>{E.launch.classList.remove("hidden"),E.body.style.background="hsl(140, 50%, 25%)",E.instructions.innerHTML=`
    <div>${S.skills.selected.length>0?skillRegister[S.skills.selected[S.skills.selected.length-1]].label:"Select up to 4 Skills"}</div>
  `;let t="";Object.keys(skillRegister).forEach(e=>{S.story.unlocked.includes(e)?t+=`<div id="${e}" 
        class="command centered column ${S.skills.selected.includes(e)&&"selected"}" 
        title="${skillRegister[e].label}"
        onClick="
          if (S.skills.selected.includes(this.id)) {
            S.skills.selected = S.skills.selected.filter((skill) => skill != this.id)
          } else {
            S.skills.selected.push(this.id);
            if (S.skills.selected.length > 4) {
              S.skills.selected = S.skills.selected.slice(-4);
            }
          }
          updateLauncher();
        ">
        <div class="commandIcon">${skillRegister[e].icon}</div>
        <div>${skillRegister[e].name}</div>
      </div>`:t+=`<div id="${e}" class="command centered column" title="Play to Unlock">
        <div class="commandIcon">?</div>
      </div>`}),E.picker.innerHTML=t,E.start.addEventListener("click",startGame),E.playthrough.innerHTML=`<div>Game #${S.meta.playthrough}</div>`},updateMagnitude=()=>{const[t,e,i]=[Math.min(140+10*Math.log10(S.econ.balance),240),Math.max(50-Math.log10(S.econ.balance),0),Math.max(50-3*Math.log10(S.econ.balance),10)];return E.body.style.background=`hsl(${t},${e}%,${i}%)`,Math.floor(Math.log10(S.econ.balance))>S.meta.magnitude&&(S.meta.magnitude=Math.floor(Math.log10(S.econ.balance))),unitPower=S.meta.magnitude-3>0?S.meta.magnitude-3:0},updateBalance=t=>{if(S.meta.active){t>0&&(S.econ.total+=t),S.econ.balance+=t;const e=updateMagnitude();if(!S.meta.freeze&&S.econ.balance<=0)S.meta.freeze=!0,S.canvas.cats=[],S.story.narrator.addLines([{duration:4e3,line:"Oh no, we lost all the cats..."},{duration:4e3,line:"Man, my boss is gonna be so mad",callback:endPlaythrough},{line:"<i>Fin.</i>"}]);else if(t>0){const i=t/10**e;for(let n=0;n<i;n++)S.canvas.cats.length<1024?S.canvas.cats.push(new Cat):(S.canvas.cats.shift(),S.canvas.cats.push(new Cat))}else if(t<0){const i=S.canvas.cats.length-(S.econ.balance/10**e>1024?1024:S.econ.balance/10**e);for(let n=0;n<i;n++)S.canvas.cats.length>1&&S.canvas.cats.shift();i==0&&S.canvas.cats.forEach(n=>{n.updateVelocity([n.velocity[0]+n.size*(Math.random()-.5),n.velocity[1]+n.size*(Math.random()-.5)])})}updateHud()}};class Cat{constructor(e){this.id=e?.id||S.econ.total,this.orientation=e?.orientation||0,this.rotation=e?.rotation||0,this.velocity=e?.velocity||[0,0],e?.coordinates?this.coordinates=e.coordinates:this.spawn(),this.resize()}spawn(){const e=Math.random()*Math.max(...S.canvas.size)/2,i=Math.random()*Math.PI*2,[n,s]=[Math.sin(i)*e,Math.cos(i)*e];this.detectCollisions([n,s]).length>0?this.spawn():this.coordinates=[n,s]}resize(){const e=85-2.5*Math.sqrt(S.canvas.cats.length)+S.meta.magnitude;this.size=e>85?85:e}detectCollisions(e){return S.canvas.cats.filter(i=>{if(i.id!=this.id){const[n,s]=[i.coordinates[0]-e[0],i.coordinates[1]-e[1]];if(Math.sqrt(n**2+s**2)<(this.size+i.size)*S.phys.overlap)return!0}})}updateVelocity(e){this.velocity=[e[0]+(Math.random()-.5)*S.phys.noise,e[1]+(Math.random()-.5)*S.phys.noise],this.rotation+=.01*(Math.random()-.5)}updatePosition(){this.orientation+=this.rotation;const[e,i]=[this.coordinates[0]+this.velocity[0],this.coordinates[1]+this.velocity[1]],n=this.detectCollisions([e,i]);n.forEach(s=>{const[a,o]=[S.phys.damping*(s.velocity[0]+this.velocity[0])/2,S.phys.damping*(s.velocity[1]+this.velocity[1])/2];i>0?(this.updateVelocity([-a+Math.sin(Math.atan(e/i))*S.phys.gravity,-o+Math.cos(Math.atan(e/i))*S.phys.gravity]),s.updateVelocity([a-Math.sin(Math.atan(e/i))*S.phys.gravity,o-Math.cos(Math.atan(e/i))*S.phys.gravity])):e!=0&&i!=0?(this.updateVelocity([-a-Math.sin(Math.atan(e/i))*S.phys.gravity,-o-Math.cos(Math.atan(e/i))*S.phys.gravity]),s.updateVelocity([a+Math.sin(Math.atan(e/i))*S.phys.gravity,o+Math.cos(Math.atan(e/i))*S.phys.gravity])):(this.updateVelocity([-a,-o]),s.updateVelocity([a,o]))}),n.length==0&&(i>0?this.updateVelocity([this.velocity[0]-Math.sin(Math.atan(e/i))*S.phys.gravity,this.velocity[1]-Math.cos(Math.atan(e/i))*S.phys.gravity]):e!=0&&i!=0&&this.updateVelocity([this.velocity[0]+Math.sin(Math.atan(e/i))*S.phys.gravity,this.velocity[1]+Math.cos(Math.atan(e/i))*S.phys.gravity]),this.coordinates=[e,i])}render(){this.resize(),this.updatePosition();const e=S.canvas.size[0]/2+this.coordinates[0],i=S.canvas.size[1]/2+this.coordinates[1],n=1.5-.001*S.canvas.cats.length,s=new Path2D;s.arc(e,i,this.size,0,2*Math.PI),n>1&&(s.moveTo(e-this.size*Math.sin(this.orientation+Math.PI*(90/180)),i-this.size*Math.cos(this.orientation+Math.PI*(90/180))),s.lineTo(e-n*this.size*Math.sin(this.orientation+Math.PI*(30/180)),i-n*this.size*Math.cos(this.orientation+Math.PI*(30/180))),s.lineTo(e-this.size*Math.sin(this.orientation+Math.PI*(10/180)),i-this.size*Math.cos(this.orientation+Math.PI*(10/180))),s.moveTo(e-this.size*Math.sin(this.orientation-Math.PI*(10/180)),i-this.size*Math.cos(this.orientation-Math.PI*(10/180))),s.lineTo(e-n*this.size*Math.sin(this.orientation-Math.PI*(30/180)),i-n*this.size*Math.cos(this.orientation-Math.PI*(30/180))),s.lineTo(e-this.size*Math.sin(this.orientation-Math.PI*(90/180)),i-this.size*Math.cos(this.orientation-Math.PI*(90/180)))),ctx.fill(s)}}class Skill{constructor(e){this.id=e.id,this.effect=skillRegister[this.id].effect,this.icon=skillRegister[this.id].icon,this.label=skillRegister[this.id].label,this.cost=e.cost,this.cooldown=e?.cooldown||0,this.timestamp=e?.timestamp||0,this.key=e.key,this.level=e?.level||0,this.assign(),this.enabled=e?.enabled||!1,this.enabled&&this.enable(),this.repeat=null,this.accelerate=1}assign(){if(["Q","W","E","R"].includes(this.key)){E[`Key${this.key}`].title=`(${this.key}) ${this.label}`;const e=n=>{S.meta.freeze||(this.id=="s13"?this.use():this.repeat||(this.repeat=setInterval(()=>{for(let s=0;s<this.accelerate;s++)this.use();this.accelerate++},50))),n.stopPropagation()};E[`Key${this.key}`].addEventListener("mousedown",e),E[`Key${this.key}`].addEventListener("touchstart",e);const i=n=>{this.repeat&&(clearInterval(this.repeat),this.repeat=null,this.accelerate=1),n.stopPropagation()};E[`Key${this.key}`].addEventListener("mouseup",i),E[`Key${this.key}`].addEventListener("touchend",i)}}buy(){if(this.enabled&&S.econ.balance>this.cost*S.econ.discount/100)return this.level++,updateBalance(-(this.cost*S.econ.discount/100)),!0}enable(){E[`Key${this.key}`].classList.contains("hidden")&&E[`Key${this.key}`].classList.remove("hidden"),this.enabled=!0}}class HandsSkill extends Skill{constructor(e){super({id:"s1",cost:110,...e})}use(){this.buy()&&(this.cost=110+10*this.level,S.econ.base++,updateBalance(0),this.level>=1e4&&!S.story.unlocked.includes("s2")&&(S.story.unlocked.push("s2"),S.story.narrator.addLines([{duration:4e3,line:"The cats have industrialised."},{duration:4e3,line:"<i>You have unlocked the Factory skill</i>"}])))}}class FactorySkill extends Skill{constructor(e){super({id:"s2",cost:1e5,...e})}use(){this.buy()&&(this.cost=10**(5+this.level),S.econ.base*=2,updateBalance(0))}}class TimesSkill extends Skill{constructor(e){super({id:"s3",cost:1e3,...e})}use(){this.buy()&&(this.cost=1e3+10*this.level**2,S.econ.mult+=10,updateBalance(0),this.level>=1e3&&!S.story.unlocked.includes("s4")&&(S.story.unlocked.push("s4"),S.story.narrator.addLines([{duration:4e3,line:"The cats have developed propaganda."},{duration:4e3,line:"<i>You have unlocked the Media skill</i>"}])))}}class MediaSkill extends Skill{constructor(e){super({id:"s4",cost:1e5,...e})}use(){this.buy()&&(this.cost=10**(5+this.level),S.econ.mult*=2,updateBalance(0))}}class GrowSkill extends Skill{constructor(e){super({id:"s5",cost:1e4,...e})}use(){this.buy()&&(this.cost=10**(4+this.level/10),S.econ.interest+=.01,updateBalance(0),this.level>=100&&!S.story.unlocked.includes("s6")&&(S.story.unlocked.push("s6"),S.story.narrator.addLines([{duration:4e3,line:"The cats have advanced veterinary science."},{duration:4e3,line:"<i>You have unlocked the Vets skill</i>"}])))}}class VetsSkill extends Skill{constructor(e){super({id:"s6",cost:10**9,...e})}use(){this.buy()&&(this.cost*=(this.level+1)*10,S.econ.interest+=1,updateBalance(0))}}class CatnipSkill extends Skill{constructor(e){super({id:"s7",cost:0,cooldown:15e3,timestamp:0,...e})}use(){const e=new Date().getTime();e>this.timestamp+this.cooldown*S.econ.discount/100&&(this.timestamp=e,updateBalance(S.econ.base*S.econ.mult*10))}}class SpaceSkill extends Skill{constructor(e){super({id:"s8",cost:0,cooldown:6e4,timestamp:0,...e})}use(){const e=new Date().getTime();if(e>this.timestamp+this.cooldown*S.econ.discount/100){this.timestamp=e;const i=S.econ.balance*100,n=S.meta.playthrough;setTimeout(()=>{n==S.meta.playthrough&&updateBalance(i)},this.cooldown*S.econ.discount/100),updateHud()}}}class AntiCatterSkill extends Skill{constructor(e){super({id:"s9",cost:0,cooldown:5e3,timestamp:0,...e})}use(){const e=new Date().getTime();e>this.timestamp+this.cooldown*S.econ.discount/100&&(this.timestamp=e,Math.random()>1/S.meta.playthrough?updateBalance(S.econ.balance):updateBalance(1-S.econ.balance))}}class NekroSkill extends Skill{constructor(e){super({id:"s10",cost:0,...e}),this.use()}use(){this.cost==0&&(this.cost=1,S.econ.discount=100-5*S.story.unlocked.length)}}class PaydaySkill extends Skill{constructor(e){super({id:"s11",cost:0,...e}),this.use()}use(){this.cost==0&&(this.cost=1,S.econ.balance+=10**S.story.unlocked.length,S.story.milestone=S.story.unlocked.length)}}class WarSkill extends Skill{constructor(e){super({id:"s12",cost:0,...e}),this.use()}use(){this.cost==0&&(this.cost=1,S.econ.base=1e3*S.story.unlocked.length,S.econ.mult=1e3*S.story.unlocked.length,S.econ.discount*=2,S.story.milestone==0&&(S.story.milestone=6))}}class AutoSkill extends Skill{constructor(e){super({id:"s13",cost:0,...e})}use(){this.debounce=!0,this.cost==1?setTimeout(()=>{this.debounce&&(this.cost=0,S.econ.auto=0,updateBalance(0),this.flipping=!1)},500):setTimeout(()=>{this.debounce&&(this.cost=1,S.econ.auto=S.story.unlocked.length*5,updateBalance(0),this.debounce=!1)},500)}}const skillRegister={s1:{generator:t=>new HandsSkill(t),name:"Hands",icon:"&#x270B;",effect:"+1",label:"Hands: Increase the Base number of cats per click by 1. So you can the cat."},s2:{generator:t=>new FactorySkill(t),name:"Factory",icon:"&#x1F3ED;",effect:"x2 &#x270B;",label:"Factory: Double the current Base. Cats view themselves as the boss."},s3:{generator:t=>new TimesSkill(t),name:"Times",icon:"&#x274E;",effect:"+0.1",label:"Times: Increase the Mult for cats per click by 0.1x. It's always a good time."},s4:{generator:t=>new MediaSkill(t),name:"Media",icon:"&#x1F3AC;",effect:"x2 &#x274E;",label:"Media: Double the current Mult. Cats have gone viral and taken over all forms of media."},s5:{generator:t=>new GrowSkill(t),name:"Grow",icon:"&#x1F4C8;",effect:"+0.01%",label:"Grow: Increase the Interest rate of the current cat balance by 0.01%. Litters of kitties need litres of kitty litter."},s6:{generator:t=>new VetsSkill(t),name:"Vets",icon:"&#x1F3E5;",effect:"+1% &#x1F4C8;",label:"Vets: Double the current Interest. Advances in modern feline medicine have increased life expectancy."},s7:{generator:t=>new CatnipSkill(t),name:"Catnip",icon:"&#x1F33F;",effect:"Burst",label:"Catnip: Unleash a burst of 1000 clicks; 15 second cooldown. Cats are drawn in by the irresistible appeal of catnip."},s8:{generator:t=>new SpaceSkill(t),name:"Space",icon:"&#x1F680;",effect:`x100 ${blackCat}`,label:"Space: Launch an Expurrdition to the stars; 1 minute cooldown. After 1 minute gain 100x the balance at launch time."},s9:{generator:t=>new AntiCatterSkill(t),name:"Anti-Catter",icon:"&#x2728;",effect:()=>`${(100-100/S.meta.playthrough).toFixed(0)}% x2`,label:"Anti-Catter: Double or Nothing; 5 second cooldown. Chances of success permanently increase with every playthrough."},s10:{generator:t=>new NekroSkill(t),name:"Nekro",icon:"&#x1FAA6;",effect:()=>`${100-S.econ.discount}% Off`,label:"Nekro: Discount on all Purrchases; 5% off for each unlocked skill. Nekomancy pushes the boundaries of the nine lives."},s11:{generator:t=>new PaydaySkill(t),name:"Payday",icon:"&#x1F4B0;",effect:"Payday",label:"Payday: Start with a lump sum of cats; increases tenfold for each unlocked skill. The Fat Cats have been hoarding generational wealth."},s12:{generator:t=>new WarSkill(t),name:"War",icon:"&#x1F6A9;",effect:"Wartime",label:"War: Start with 1000 Base and 10x Mult for each unlocked skill. Purrchases cost double. War takes more than it gives."},s13:{generator:t=>new AutoSkill(t),name:"Auto",icon:"&#x2699;&#xFE0F;",effect:()=>`Auto:${5*S.story.unlocked.length}`,label:"Auto: 5 automatic clicks per second for each unlocked skill. Can be toggled on/off."}};class Narrator{constructor(e){this.currentLine=e?.currentLine||{line:"please DO NOT the cat"},this.queue=e?.queue||[],this.queue.length==0&&this.loadLines(),this.sayLine(this.currentLine.line)}loadLines(){this.queue=[{line:"please DO NOT the cat"},{predicate:13,line:"AHHH! What are you doing?"},{predicate:25,line:"HEY!"},{predicate:40,line:"Quit it!"},{predicate:55,line:"PLEASE?"},{predicate:70,line:"Okay."},{predicate:85,line:"You're really doing this"},{predicate:130,line:"Look..."},{predicate:200,line:"I can't say I didn't warn you"},{predicate:400,line:"But if you're going to commit..."},{predicate:600,line:"You should do it properly."},{predicate:800,line:"The better you treat them, the better they'll treat you"},{predicate:1300,line:"Give and you shall receive"},{predicate:2e3,line:"It's just the way the universe works"},{predicate:4e3,line:"Or at least that's what I was told..."},{predicate:6e3,line:"We sure have a lot of cats now. Have you ever wondered where they come from?"},{predicate:8e3,line:"When a mommy and daddy cat love each other very much..."},{predicate:13e3,line:"But really. Is this bottomless ball of cats not a mystery to you?"},{predicate:2e4,line:"The truth is..."},{predicate:4e4,line:"...something along the lines of..."},{predicate:7e4,line:"<i>*pages flicking*</i>"},{predicate:1e5,line:"...I don't know either."},{predicate:2e5,line:"..."},{predicate:4e5,line:"Hey. Don't judge me. It's my first day!"},{predicate:7e5,line:"What's the worst that could possibly happen?"},{predicate:3*10**6,line:"The cats are really taking over the city..."},{predicate:1*10**7,line:"Have you noticed anything strange?"},{predicate:3*10**7,line:"They seem... smarter"},{predicate:1*10**8,line:"It's like there's a cat society"},{predicate:3*10**8,line:"...I'm so not getting paid enough for this"},{predicate:3*10**9,line:"I think they're calling it... Catitalism?"},{predicate:1*10**10,line:"Imperium. Supremus. Felis."},{predicate:3*10**10,line:"That's one real Cat Empire"},{predicate:1*10**11,line:"Do you think they're satisfied?"},{predicate:3*10**11,line:"I think they're hungry for more"},{predicate:3*10**12,line:"What do they want after world domination?"},{predicate:3*10**13,line:"They're building... some sort of structure"},{predicate:3*10**14,line:"<i>*pages flicking frantically*</i>"},{predicate:3*10**15,line:"This goes beyond my training"},{predicate:3*10**16,line:"AND WHERE DO THEY KEEP COMING FROM?"},{predicate:3*10**17,line:"They can't possibly be from Earth"},{predicate:10**20,line:"Maybe they came from another planet?"},{predicate:10**25,line:"Or another solar system?"},{predicate:10**30,line:"Perhaps they just want to go home..."},{predicate:10**45,line:"To a galaxy, far far away..."},{predicate:10**40,line:"<i>*muffled phone call noises*</i>"},{predicate:10**50,line:"Ok. Scratch that."},{predicate:10**60,line:"There's more cats than matter in the universe."},{predicate:10**70,line:"Don't even start thinking about the multiverse"},{predicate:10**80,line:"We're beyond the laws of physics here"},{predicate:10**90,line:"Can you just accept that? I want to go home."},{predicate:10**100,line:"<i>Fin.</i>"}]}addLines(e){this.queue.unshift(...e)}nextLine(){(!this.currentLine.duration||new Date().getTime()>this.currentLine.timestamp+this.currentLine.duration)&&(this.queue.length>0?(!this.queue[0].predicate||typeof this.queue[0].predicate=="number"&&S.econ.balance>this.queue[0].predicate||typeof this.queue[0].predicate=="function"&&this.queue[0].predicate())&&(this.currentLine.callback&&this.currentLine.callback(),this.currentLine=this.queue[0],this.currentLine.timestamp=new Date().getTime(),this.sayLine(this.currentLine.line),this.queue.shift()):this.currentLine={line:"..."})}sayLine(e){E.dialogue.innerHTML=e}}const storyMegacat=()=>{S.story.milestone=6,S.story.unlocked.includes("s7")||(S.skills.selected.push("s7"),S.story.unlocked.push("s7"),S.skills.bindings.R=skillRegister.s7.generator({key:"R"})),S.econ.drain=5e4,S.story.narrator.addLines([{duration:4e3,line:"WHAT. IS. THAT?"},{duration:4e3,line:"It's a... MEGACAT"},{duration:4e3,line:"ITS CONSUMING ALL THE OTHER CATS"},{duration:4e3,line:"Quick, go get the CATNIP"},{duration:4e3,line:"We need to FEED THE BEAST"},{duration:4e3,line:"KEEP FEEDING IT"},{duration:4e3,line:"WE HAVE TO SAVE THE CATS"},{duration:4e3,line:"ALMOST THERE!!!",callback:()=>{S.econ.drain=0}},{duration:4e3,line:"Phew! That was a close one."}])},storyGigacat=()=>{S.story.milestone=9,S.econ.drain=6*10**7,S.story.narrator.addLines([{duration:4e3,line:"Uh oh. This is bad."},{duration:6e3,line:"The cats are seizing the means of production!"},{duration:4e3,line:"It's a full blown revolution!"},{duration:6e3,line:"What will you do? Will you support them?"},{duration:4e3,line:"They're losing numbers FAST"},{duration:4e3,line:"Don't let this be for nothing!"},{duration:4e3,line:"They're storming the capital!!!",callback:()=>{S.econ.drain=0,S.story.unlocked.includes("s11")||(S.story.unlocked.push("s11"),S.story.narrator.addLines([{duration:4e3,line:"<i>You have unlocked the Payday skill</i>"}]))}},{duration:4e3,line:"The Fat Cats are in charge now."}])},storyTeracat=()=>{S.story.milestone=12,S.econ.drain=7*10**10,S.story.narrator.addLines([{duration:4e3,line:"<i>*Cat Empire has declared war*</i>"},{duration:4e3,line:"They're launching an all-out invasion!"},{duration:6e3,line:"Fighting on every front!"},{duration:6e3,line:"It's a sheer battle of numbers"},{duration:6e3,line:"100 cats vs every person!"},{duration:6e3,line:"An absolute meownstrosity!"},{duration:6e3,line:"They're almost taken the last outpost."},{duration:4e3,line:"Pushing through the final defences...",callback:()=>{S.econ.drain=0,S.story.unlocked.includes("s12")||(S.story.unlocked.push("s12"),S.story.narrator.addLines([{duration:4e3,line:"<i>You have unlocked the War skill</i>"}]))}},{duration:4e3,line:"The cats now control the Earth."}])},storyPetacat=()=>{S.story.milestone=15,S.econ.drain=8*10**13,S.story.narrator.addLines([{duration:4e3,line:"Okay. So it's a Megalith."},{duration:4e3,line:"A place of ritual sacrifice"},{duration:6e3,line:"They're trying to unlock the secrets of immortality!"},{duration:4e3,line:"It's costing trillions of lives!"},{duration:6e3,line:"Is this what happens when you have everything?"},{duration:6e3,line:"You know, I feel sorry for them."},{duration:6e3,line:"In the end they became their own demise...",callback:()=>{S.econ.drain=0,S.story.unlocked.includes("s10")||(S.story.unlocked.push("s10"),S.story.narrator.addLines([{duration:4e3,line:"<i>You have unlocked the Nekro skill</i>"}]))}},{duration:4e3,line:"WAIT. WHAT!?!"},{duration:4e3,line:"The Nekomancers have uncovered the key to resurrection."},{duration:4e3,line:"I did not sign up for this. Did you?"}])},storyExacat=()=>{S.story.milestone=18,S.econ.drain=10**17,S.story.narrator.addLines([{duration:6e3,line:"The cats have launched a space program."},{duration:4e3,line:"Their ships are fueled by... catpower!"},{duration:4e3,line:"Just pushing each other up!"},{duration:4e3,line:"Outwards and onwards to the stars"},{duration:4e3,line:"KEEP GOING"},{duration:4e3,line:"They've nearly escaped the Earth's gravity",callback:()=>{S.econ.drain=0,S.story.unlocked.includes("s8")||(S.story.unlocked.push("s8"),S.story.narrator.addLines([{duration:4e3,line:"<i>You have unlocked the Space skill</i>"}]))}},{duration:4e3,line:"They're off to explore the galaxy"},{duration:4e3,line:"I wonder where they'll go"}])},storyInfinity=()=>{S.meta.freeze=!0,S.story.milestone=100,E.body.style.background="black",E.counter.innerHTML="",E.interest.innerHTML="",S.canvas.cats=[],S.story.narrator.addLines([{duration:4e3,line:"Well. You've done it"},{duration:4e3,line:"The whole universe is full of cats"},{duration:4e3,line:"I hope you're happy"},{duration:4e3,line:"You can finally go do someting else with your life"},{duration:4e3,line:"What?"},{duration:4e3,line:"You're wondering what's next?"},{duration:4e3,line:"Seriously. There's nothing."},{duration:4e3,line:"..."},{duration:4e3,line:"Oh go away. I've got a huge mess to clean up"},{duration:4e3,line:"<i>*sigh*</i>"},{duration:6e3,line:"Have you heard the saying about curiosity?",callback:()=>{E.body.style.background="white"}},{duration:6e3,line:"<i>Fin.</i>",callback:endPlaythrough},{line:"<i>Fin.</i>"}]),S.story.unlocked.includes("s9")||(S.story.unlocked.push("s9"),S.story.narrator.addLines([{duration:4e3,line:"<i>You have unlocked the Anti-Catter skill</i>"}]))},storyAutocat=()=>{S.meta.freeze=!0,S.canvas.cats=[],S.story.narrator.addLines([{duration:4e3,line:"You did not the cat."},{duration:4e3,line:"Thanks for watching it!"},{duration:4e3,line:"You've saved me from a lot of trouble. Here have this..."},{duration:4e3,line:"<i>You have unlocked the Auto skill</i>",callback:endPlaythrough},{line:"<i>Fin.</i>"}])},endPlaythrough=()=>{S.canvas.cats=[],S.econ={auto:0,balance:1,base:1,discount:100,drain:0,interest:0,mult:100,total:0},S.meta.active=!1,S.meta.freeze=!1,S.meta.magnitude=0,S.meta.playthrough+=1,S.story.milestone=0,S.story.narrator=new Narrator,saveGame()},renderFrame=()=>{ctx.clearRect(0,0,...S.canvas.size),S.canvas.cats.forEach(t=>{t.render()})};setInterval(renderFrame,50);const patCat=()=>{S.meta.freeze||(updateBalance(S.econ.base*S.econ.mult/100),!S.meta.mute&&S.meta.active&&meows[Math.floor(meows.length*Math.random())].play())};E.canvas.addEventListener("click",patCat),E.dialogue.addEventListener("click",patCat);const tickInterval=setInterval(()=>{const t=new Date().getTime()-S.meta.starttime;if(t%12e4<1e3&&saveGame(),S.meta.active?(S.story.unlocked.includes("s1")||S.econ.balance>110&&(S.story.unlocked.push("s1"),S.skills.selected.push("s1"),S.skills.bindings.Q=skillRegister.s1.generator({key:"Q"}),S.story.narrator.addLines([{line:"I'll find someone to take them off your HANDS"}])),S.story.unlocked.includes("s3")||S.econ.balance>1e3&&(S.story.unlocked.push("s3"),S.skills.selected.push("s3"),S.skills.bindings.W=skillRegister.s3.generator({key:"W"}),S.story.narrator.addLines([{line:"They'll go out and tell others about the good TIMES"}]),S.story.narrator.sayLine("")),S.story.unlocked.includes("s5")||S.econ.balance>1e4&&(S.story.unlocked.push("s5"),S.skills.selected.push("s5"),S.skills.bindings.E=skillRegister.s5.generator({key:"E"}),S.story.narrator.addLines([{line:"They want to have kittens! Maybe we should give them space to GROW?"}])),S.meta.magnitude>=100?S.story.milestone<100&&storyInfinity():S.meta.magnitude>=18?S.story.milestone<18&&storyExacat():S.meta.magnitude>=15?S.story.milestone<15&&storyPetacat():S.meta.magnitude>=12?S.story.milestone<12&&storyTeracat():S.meta.magnitude>=9?S.story.milestone<9&&storyGigacat():S.meta.magnitude>=6&&S.story.milestone<6&&storyMegacat(),S.story.unlocked.includes("s13")||S.econ.balance==1&&t>2e4&&(S.story.unlocked.push("s13"),storyAutocat())):updateLauncher(),!S.meta.freeze){if(S.econ.interest>0&&updateBalance(Math.floor(S.econ.balance*S.econ.interest/100)),S.econ.auto>0)for(let e=0;e<S.econ.auto;e++)setTimeout(()=>{patCat()},10*e);S.econ.drain>0&&updateBalance(-S.econ.drain)}updateHud(),S.story.narrator.nextLine()},1e3);E.pause.addEventListener("click",t=>{E.menu.classList.toggle("hidden"),t.stopPropagation()}),E.mute.addEventListener("click",t=>{S.meta.mute=!S.meta.mute,updateHud(),t.stopPropagation()}),E.restart.addEventListener("click",t=>{endPlaythrough(),updateLauncher(),E.menu.classList.add("hidden"),t.stopPropagation()}),E.clear.addEventListener("click",t=>{resetGame(),t.stopPropagation()});const hotkeydown=t=>{S.meta.active&&(["KeyQ","KeyW","KeyE","KeyR"].includes(t.code)?document.getElementById(t.code).dispatchEvent(new Event("mousedown")):(t.code==="Space"||t.key===" ")&&patCat())};document.addEventListener("keydown",hotkeydown,!1);const hotkeyup=t=>{["KeyQ","KeyW","KeyE","KeyR"].includes(t.code)&&document.getElementById(t.code).dispatchEvent(new Event("mouseup")),(t.code==="Escape"||t.key==="Escape")&&E.pause.click()};document.addEventListener("keyup",hotkeyup,!1),navigator.userAgent.match(/FBAN|FBAV|Instagram/i)?(document.body.outerHTML=`
    <div style="position: fixed; top: 50%; left: 50%; transform: translate(-50%, -50%);">
      Please open this page in your primary browser for the best gameplay experience
    </div>
  `,clearInterval(tickInterval)):loadGame()||startGame();
