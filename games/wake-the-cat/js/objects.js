import{Group as t,Mesh as e,Object3D as a,MeshStandardMaterial as n,DoubleSide as r,FrontSide as s,CylinderGeometry as o,TorusGeometry as l,BoxGeometry as w,CapsuleGeometry as d,SphereGeometry as F,ConeGeometry as m,PlaneGeometry as c,DirectionalLight as y,AmbientLight as p}from"three";import{textures as b}from"./textures.js";import{sFX as u}from"./sounds.js";const i=t=>({x:t.x??0,y:t.y??0,z:t.z??0,rx:t.rx??0,ry:t.ry??0,rz:t.rz??0,d:t.d??500,snd:t.snd??(()=>{})});function h(t,e){return e.some(e=>e.sub&&e.sub[t])?e.map(e=>e.sub&&e.sub[t]?e.sub[t]:{}).map(i):null}export const cat=(t,e,a,n=!1)=>{var r=[{g:objF.cat(null,"#FFE","#48F"),p:{s:.5}},{g:objF.cat(b.tabby("#0008","#FA0"),"#FA0","#0F0"),p:{sx:.8,sz:.7}},{g:objF.cat(b.tabby("#0004","#888"),"#AAA","#FD0"),p:{sx:1.3,sy:1.3}},{g:objF.cat(b.blochy("#000F"),"#FFF","#FD0")},{g:objF.cat(b.blochy("#000A","#000F",null,8),"#FFF","#AF8")},{g:objF.cat(b.blochy("#A80A","#F82A","#000A",5),"#FFF","#0F0")},{g:objF.cat(b.blochy("#A60","#000",0,3),"#FFF","#AA0")},{g:objF.cat(null,"#FA0","#FF0")},{g:objF.cat(b.tabby("#F804","#FFF"),"#FA0","#FF0")},{g:objF.cat(b.blochy("#DA0",null,null,8),"#FFF","#FF0")},{g:objF.cat(b.blochy("#8508","#FA48","#000A",15),"#FFF","#FF0"),p:{sx:1.3,sz:1.3}},{g:objF.cat(null,"#888","#8A0"),p:{s:.8}},{g:objF.cat(null,"#000","#FF0")}][t];return{n:"cat"+(n?t:""),g:r.g,p:{...r.p,...e},r:a}};function z(n,r,s=[{}],o={}){const l=new t,w=[l];r.forEach((t,a)=>{var r=Array.isArray(n)?n[a]??n[0]:n,s=new e(t,r);s.castShadow=!0,s.receiveShadow=!0,w.push(s),l.add(s)});const d=new a;return d.sts=[...s].map(i),d.bits=w.map((t,e)=>({node:t,sts:h(e,s)})),o&&(d.p_adds=o,Object.assign(d,o)),d.add(l),d}export const msm=(t,e,a=1,o,l,w=0,d)=>new n({color:t,map:e,roughness:a,bumpMap:o,bumpScale:l,metalness:w,side:d?r:s});export const wObj=t=>{const a=new e(new c(100,100,10,10),msm("#262",b.pitted(3,100),.2,b.pitted(5,44),1));a.receiveShadow=!0,a.rotation.x=-Math.PI/2,t.add(a);const n=new p(16777215,.5);t.add(n);const r=new y(16777215,1);r.position.set(25,35,5),r.castShadow=!0,r.shadow.mapSize.width=2048,r.shadow.mapSize.height=2048,r.shadow.camera.near=1,r.shadow.camera.far=100,r.shadow.camera.left=-100,r.shadow.camera.right=100,r.shadow.camera.top=100,r.shadow.camera.bottom=-100,t.add(r)};export const objF={basket:()=>z(msm(null,b.frame(),.1,null,null,0,!0),[new o(4,4.2,.3,32).translate(0,-.5,0),new l(4,.5,10,30).rotateX(1.57),new l(4.3,.5,10,30,5.5).rotateX(1.57).translate(0,.9,0),new l(4.6,.5,10,30,5).rotateX(1.57).translate(0,1.8,0).rotateY(-.25),new l(4.7,.5,10,30,4.8).rotateX(1.57).translate(0,2.7,0).rotateY(-.375)],[],{passDown:!0}),plat:(t=8)=>z(msm("#EC8",b.wood(),.5),[new w(8,.5,8).translate(0,0,0),new o(1,1,t,10).translate(0,-t/2,0)],[],{passDown:!0}),gRing:(t=5)=>z(msm("#AA0",null,.1,b.pitted(10,20),1,.8),[new l(.45,.25,12,20).translate(0,0,.1),new w(.3,t,.3).translate(0,-t/2-.3,.15)],[],{passDown:!0}),needle:(t=6)=>z([msm("#A95",b.wood(1),.2,b.diag(),2),msm("#A95",b.wood(1),.2)],[new o(.25,.25,t,25),new o(.7,.8,1,25).translate(0,t/2+.5,0),new o(.25,.01,3,25).translate(0,-t/2-1.5,0)],[{d:1200,snd:u.spin},{d:800,snd:u.spin,y:-(t+1),sub:{0:{ry:6.28}}}]),hinge:()=>{const t=msm("#FF8",null,0,b.wood(2),1,.4);return z([msm("#A95",b.wood(2),.2),t,t,t],[new w(2,2,2).translate(1.2,1.1,0),new w(2,.05,2).translate(1.2,.1,0),new o(.25,.25,2).translate(0,0,0).rotateX(1.57),new w(2,.05,2).translate(1.2,-.1,0),new w(2,2,2).translate(1.2,-1.1,0)],[{d:3e3,snd:u.hng},{d:300,snd:u.hng,rz:1.57,sub:{4:{rz:-1.57},5:{rz:-1.57}}}])},press:()=>{var t=msm("#FFD",null,.1,b.lines(),2,.8);return z([msm("#800",null,.2,b.dimple(10),2),t,t],[new o(2,2,4,20,4),new o(1.5,1.5,4,20,4).translate(0,.5,0),new o(1.2,1.2,4,20,4).translate(0,1,0),new o(2,2,.5,20).translate(0,3,0)],[{d:800,snd:u.woosh},{d:1200,snd:u.wooshUp,y:3,sub:{1:{y:-3}}},{d:1200,snd:u.wooshUp,y:6,sub:{1:{y:-6},2:{y:-3}}}])},wheel:()=>z(msm("#AA0",null,.1,b.pitted(10,20),1,.8),[new l(5.5,.8,20,40).rotateX(1.57),new l(1.5,.5,10,20).rotateX(1.57),new d(.3,7,5,10,3).rotateX(1.57).translate(0,0,5),new d(.3,4.5,5,10,3).translate(0,3.5,0).rotateX(1.57).rotateY(6.28/3),new d(.3,4.5,5,10,3).translate(0,3.5,0).rotateX(1.57).rotateY(-6.28/3)],[{d:1e3,snd:u.grind},{d:1e3,snd:u.grind,ry:1.57},{d:1e3,snd:u.grind,ry:3.14},{d:1e3,snd:u.grind,ry:4.71},{d:1e3,snd:u.grind,ry:6.28}],{wrapState:!0}),sign:(t,e,a,n,r)=>z([msm("#A84",b.wood(2),1),msm(null,b.text(t,e,a,n,r,"#000","#CC8"),.8,b.text(t,e,a,n,"#000","#FFF"),4)],[new w(6,6,.1).translate(0,8,0),new w(5.5,5.5,.1).translate(0,8,.1),new w(.5,6,.5).translate(0,2.5,0)],[],{passDown:!0}),cat:(t,e="#000",a="#FF0")=>{let n=msm(a,b.eye());return z([msm(e,t,.7,b.fur(),2,0,!0),n,n],[new d(1,2,5,10).rotateX(1.57).translate(0,0,0),new F(.2).rotateY(-1.57).rotateX(-.785).translate(.3,1.8,2.3),new F(.2).rotateY(-1.57).rotateX(-.785).translate(-.3,1.8,2.3),new d(.6,1).rotateX(1.57).translate(0,1,2),new d(.8,1).rotateX(.785).translate(0,1,1.5),new F(1.1).translate(0,.2,-1.2).scale(1.2,1,1),new o(.1,.4,2.5).rotateX(1.57).rotateY(-.157).translate(-.7,-.8,2),new o(.1,.4,2.5).rotateX(1.57).rotateY(.157).translate(.7,-.8,2),new o(.2,.4,2.5).rotateX(1.77).rotateY(.157).translate(1,-.5,0),new o(.2,.4,2.5).rotateX(1.77).rotateY(-.157).translate(-1,-.5,0),new m(.3,.9,8,1,!0,1.57,3.14).translate(.3,2.3,2.2),new m(.3,.9,8,1,!0,1.57,3.14).translate(-.3,2.3,2.2),new l(1,.15,6,12,4).rotateX(-1.57).scale(1,2,1.5).translate(-1,0,-2.2)],[{d:1e3},{d:1e3,snd:u.mew,rz:0,sub:{2:{y:-1.1,z:.2,x:-.1},3:{y:-1.1,z:.2,x:.1},4:{y:-1,z:.3},5:{rx:.5},7:{z:-.2,x:.5},8:{z:-.2,x:-.5},11:{x:-.8,y:-1,z:.5,rz:-.5},12:{x:.8,y:-1,z:.5,rz:.5},13:{x:1,y:0,ry:.7}}},{snd:u.yowl,d:1e3,rx:-.5,z:5,y:3,sub:{2:{x:-1,y:0,z:.8,ry:.5},3:{x:1,y:0,z:.8,ry:-.5},7:{ry:-.5,rx:.5,y:1,z:1},8:{ry:.5,rx:.5,y:1,z:1},9:{rx:2.5,z:-2.5,y:-1.2},10:{rx:2.5,z:-2.5,y:-1.2},11:{x:-1,y:.6,z:0,rz:-1},12:{x:1,y:.6,z:0,rz:1},13:{z:1,y:1,rz:-2}}}],{passDown:!0})}};