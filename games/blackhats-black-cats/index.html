<!DOCTYPE html><html lang="en"><head><meta charset="UTF-8" /><meta name="viewport" content="width=device-width, initial-scale=1.0" /><title>BLACKHAT'S</title>  <script type="module">(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const a of document.querySelectorAll('link[rel="modulepreload"]'))i(a);new MutationObserver(a=>{for(const o of a)if(o.type==="childList")for(const s of o.addedNodes)s.tagName==="LINK"&&s.rel==="modulepreload"&&i(s)}).observe(document,{childList:!0,subtree:!0});function n(a){const o={};return a.integrity&&(o.integrity=a.integrity),a.referrerPolicy&&(o.referrerPolicy=a.referrerPolicy),a.crossOrigin==="use-credentials"?o.credentials="include":a.crossOrigin==="anonymous"?o.credentials="omit":o.credentials="same-origin",o}function i(a){if(a.ep)return;a.ep=!0;const o=n(a);fetch(a.href,o)}})();let C={knownWitches:new Map,spells:new Map,witches:new Map,entities:new Map,bondings:new Map,completedBondings:new Map,expiredBondings:new Map,news:new Map,catAcquisition:new Map,happenings:new Map,day:1,creations:1,catInventory:new Map,maxCatInventorySize:10,cats:new Map,selectedBonding:null,selectedCat:null,currentScreen:"catInventory",remainingTime:16,maxTime:16,gp:100,notifications:new Map,traps:new Map,catCatcher:new Map,selectedAcqusition:"traps",renown:15,expenses:0,bank:null};const qt={knownWitches:new Map,spells:new Map,witches:new Map,entities:new Map,bondings:new Map,completedBondings:new Map,expiredBondings:new Map,news:new Map,catAcquisition:new Map,happenings:new Map,day:1,creations:1,catInventory:new Map,maxCatInventorySize:10,cats:new Map,selectedBonding:null,selectedCat:null,currentScreen:"catInventory",remainingTime:16,maxTime:16,gp:100,notifications:new Map,traps:new Map,catCatcher:new Map,selectedAcqusition:"traps",renown:115,expenses:0,bank:null},v=t=>document.getElementById(t),Q=v("day"),zt=v("close-dialog"),k=v("dialog"),L=v("screen"),tt=v("dialog-content"),bt={getSpellFromBonding:.05,discoverNewWitch:.25},et={trap:{value:100},bonding:{value:500}},st={bonding:{maxRenown:100,maxFailedRenown:-100}},Ht=["0","10","50","100","250","500"],rt={0:{max:.1,min:.05},10:{max:.25,min:.1},50:{max:.5,min:.1},100:{max:1,min:1},250:{max:1.5,min:1.5},500:{max:2,min:2}},Gt={0:{max:.05,min:.05},10:{max:.1,min:.05},50:{max:.25,min:.1},100:{max:.5,min:.25},250:{max:.75,min:.5},500:{max:1,min:.75}},D={0:{max:9,min:0},10:{max:49,min:10},50:{max:99,min:50},100:{max:249,min:100},250:{max:499,min:250},500:{max:750,min:500}},K=["Tabby","Siamese","Persian","Maine Coon","Bengal","Sphynx","Ragdoll","British Shorthair","Abyssinian","Scottish Fold"],G={Tabby:{value:7,color:["orange","greytone"]},Siamese:{value:25,color:["white"]},Persian:{value:30,color:["white","grey","black","orange"]},"Maine Coon":{value:15,color:["white","orange","greytone","black"]},Bengal:{value:45,color:["orange","greytone"]},Sphynx:{value:20,color:["pink","grey","black","white"]},Ragdoll:{value:35,color:["white"]},"British Shorthair":{value:15,color:["black","grey","white","orange"]},Abyssinian:{value:40,color:["orange"]},"Scottish Fold":{value:25,color:["grey","white","greytone","black","orange"]}},Ot=["black","orange","greytone","white","grey","pink"],Pt=t=>Object.keys(G).filter(e=>G[e].color.includes(t)),lt=()=>Object.keys(G).filter(t=>G[t].color.includes("black")),yt=["affectionate","calm","charming","clever","independent","mischievous","playful","possessive","reclusive","stubborn","vocal","agressive","thoughtful","short fused","defiant","greedy"],ct=["Alioth","Nimue","Oliver","Quicksilver","Raven","Stian","Sylph","Talon","Void","Voodoo","Wraith","Zorya"],dt=["Adeline","Aelin","Agatha","Allegra","Calliope","Cassandra","Georgianna","Gladys","Hazel","Heather","Helga","Hestia","Moxie","Nebula","Odette","Olga","Salome","Scarlet","Seraphina","Sherah","Ursula","Vandelia","Vashti","Zelia","Zephyra","Zelda"],ut=["Addicock","Amondsham","Atherton","Barnaby","Beauchamp","Beaumont","Blount","Brook","Chatwyn","Chilton","Cheddar","Cockayne","Coggshall","Cossington","Culpepper","Dogmersfield","Dusteby","Flexney","Fortescue","Latham","Leventhorpe","Markeley","Massingberd","Mauntell","McSpooky","Menzies","Motesfont","Piggott","Pinncock","Polsted","Radcliffe","Risley","Roper","Strelley","Sweetecok","Tabard","Warbulton","Wexcombe","Winthrop","Wistring","Worsley","Wreke"],ht=["Alchemist","Diviner","Enchantress","Herbalist","Necromancer","Satanist"],pt=[["Animist","Materialist"],["Authoritarian","Egalitarian"],["Exploratory","Scholastic"],["Extremist","Moderate"],["Purist","Syncretic"]],Yt='<svg width="50px" height="50px" viewBox="0 0 64 64" version="1.1" id="svg1" xml:space="preserve" xmlns="http://www.w3.org/2000/svg" xmlns:svg="http://www.w3.org/2000/svg"><defs id="defs1" /><g id="layer2"><path style="fill:#000000;stroke-width:0.264583" d="m 27.975404,17.69607 -4.554135,-5.204727 16.915362,-11.3202796 -3.51319,11.1901616 8.587798,4.163781 -9.758863,6.245672 4.293899,4.163781 19.647842,2.992718 -3.750919,5.626027 -7.699478,2.701534 -9.636331,-2.619851 -11.169547,1.218204 -9.511654,3.873893 L 9.2277009,38.233372 5.4649629,33.440367 18.737015,29.66694 Z" id="path1" /><ellipse style="fill:#000000;fill-opacity:0;stroke:#000000;stroke-width:2.973;stroke-dasharray:none;stroke-opacity:1" id="path2" cx="32.334358" cy="39.946278" rx="15.554242" ry="12.626583" /><path style="fill:#000000;fill-opacity:1;stroke:none;stroke-width:2.97299;stroke-dasharray:none;stroke-opacity:1" d="m 19.908079,48.79431 -8.067326,12.100988 45.93171,-4.033663 -10.799807,-10.799807 -7.546853,5.725199 -12.100989,0.13012 z" id="path3" /></g></svg>',jt='<svg width="50" height="50" viewBox="0 0 13.229167 13.229167" version="1.1" id="svg1" xml:space="preserve" xmlns="http://www.w3.org/2000/svg" xmlns:svg="http://www.w3.org/2000/svg"><defs id="defs1" /><g id="layer3"><ellipse style="fill:#000000;stroke-width:3.46405" id="path1" cx="6.7165418" cy="6.762547" rx="5.7044616" ry="4.6463757" /><path style="fill:#000000;stroke-width:2.97299" id="path2" d="m 3.8643123,0.87407064 -3.58828998,2.07170016 0,-4.1434003 z" transform="matrix(1.2307693,0,0,1.2109549,1.0403918,2.0007871)" /><path style="fill:#000000;stroke-width:2.97299" id="path3" d="M 14.445168,-3.0822493 14.309456,4.1726843 8.0943555,0.42768766 Z" transform="matrix(0.6015936,0,0,0.80976924,3.730884,2.3578993)" /><ellipse style="fill:#ffffff;fill-opacity:1;stroke-width:2.19414" id="path4" cx="5.0302038" cy="5.2399859" rx="1.472119" ry="0.73605949" transform="rotate(5)" /><ellipse style="fill:#ffffff;fill-opacity:1;stroke-width:2.19414" id="path4-7" cx="-8.5396643" cy="-6.8836594" rx="1.472119" ry="0.73605949" transform="rotate(172.4)" /><ellipse style="fill:#000000;fill-opacity:1;stroke-width:2.97299" id="path5" cx="4.5083642" cy="5.612453" rx="0.55204457" ry="0.9660781" /><ellipse style="fill:#000000;fill-opacity:1;stroke-width:2.97299" id="path5-7" cx="9.3521757" cy="5.6129494" rx="0.55204457" ry="0.9660781" /><path style="fill:#000000;fill-opacity:1;stroke-width:2.97299" d="m 2.3461896,9.2467471 c 0,0 -0.7003033,0.3421585 -1.0104363,1.2343839 -0.310133,0.892226 -0.1856604,1.801861 -0.1856604,1.801861 0,0 1.439634,0.523797 5.4728956,0.388576 4.0332615,-0.135221 5.1539625,-0.618594 5.1539625,-0.618594 0,0 0.167413,-0.564258 0.08065,-1.368828 -0.08676,-0.8045692 -0.632697,-1.4373989 -0.632697,-1.4373989 z" id="path6" /><path style="fill:#ffffff;fill-opacity:1;stroke-width:2.97299" id="path7" d="M 7.5906136,8.8787176 3.8179848,7.284541 7.0848966,4.8144369 Z" transform="matrix(0.20851111,0.12038394,-0.09843707,0.17049801,6.328186,5.3769613)" /></g></svg>',R=C;function J(t,e){return R.renown<750&&R.renown>0&&(R.renown+=t*e,R.renown<0&&(R.renown=0),R.renown>750&&(R.renown=750)),R.renown}function B(t){const e=t;return Object.entries(D).find(([i,a])=>a.max>=e&&e>=a.min)[0]}let S=C;const p=t=>document.createElement(t);function c(t,e){return t.getElementById(e)}function Kt(t,e){e.forEach(n=>t.appendChild(n))}function y(t,e){for(;t.firstChild;)t.lastChild&&t.removeChild(t.lastChild);e.forEach(n=>t.appendChild(n))}const u=(t,e=0)=>Math.floor(Math.random()*(t-e))+e,_t=(t,e)=>Math.random()*(t-e)+e,z=()=>(u(1e5)*performance.now()).toString();function nt(t,e,n){const i=[...t];let a=e;const o=[];if(n&&u(101)<=n)return[];if(a>=i.length)return t;for(let s=0;s<u(a)+1;s++)o.push(...i.splice(u(i.length),1));return o}function vt(){const t=S.witches;return Array.from(t.values())[u(t.size)]}function Ut(){const t=S.witches,e=Array.from(t.values()).filter(i=>!i.inbonding&&!i.relationship),n=Zt(e);return n.length<1&&n.push(kt(void 0,void 0,D[B(S.renown)].min,D[B(S.renown)].max)),n[u(n.length)]}function Zt(t){return t.filter(e=>S.renown<D[B(e.value)].max&&S.renown>D[B(e.value)].min)}function wt(t){return{days:Math.floor(t/16),ticks:t%16}}function A(t){return Array.from(S[t].values())}const F=C,q=["name","type","deceased","inBonding","effectingspells"],Vt=["vocation"],Qt=["age","sex","approach","species","traits"],Jt=["sex","color"],Xt=["age","variant"],te=["value","color"],ee=["variant","age","value","color"];function Y(t){const e={...t},{type:n,knowns:i,traits:a,knownTraits:o}=e,s=[];if(o.length!==a.length&&s.push("traits"),(n==="cat"?Xt:Qt).forEach(r=>{i.includes(r)||s.push(r)}),s.length<1)return!1;const l=s[u(s.length)];if(l==="traits"){const r=a.filter(m=>!o.includes(m)),f=r[u(r.length)];return t.knownTraits.push(f),f}else t.knowns.push(l);return e[l]}function ne(t){const e=["age","vocation","approach"],n=[],i=t.agent;return i.knownTraits.length!==i.traits.length&&n.push("traits"),n.push(...e.filter(a=>!t.agent.knowns.includes(a))),n.length>0?n:!1}class U{id;type;inbonding;name;knowns;relationship;age;deceased;sex;value;color;species;traits;knownTraits;variant;effectingspells;vocation;approach;constructor(e,n,i=!1,a,o=[],s,l,r,f,m,T,x=null,N,Nt,Ft=null,Wt=[],Dt=null,Lt=null){this.id=e,this.type=n,this.inbonding=i,this.name=a,this.knowns=[...n==="cat"?Jt:Vt,...o],this.relationship=s,this.age=l,this.deceased=r,this.sex=f,this.value=m,this.color=T,this.species=x,this.traits=N,this.knownTraits=Nt,this.variant=Ft,this.effectingspells=Wt,this.vocation=Dt,this.approach=Lt}}function ie(t){const e=z(),n=ct[Math.floor(Math.random()*ct.length)],i=K[Math.floor(Math.random()*K.length)],a=it(u(6,4)),o=new U(e,"cat",!1,n,[],null,u(27,1),!1,"Male",u(50),"black","Feline",a,nt(a,2,10),i,[],null,null);return t??F.catInventory.set(e,o),F.entities.set(e,o),F.cats.set(e,o),o}function kt(t=!1,e,n=0,i=9){const a=z(),o=dt[u(dt.length)],s=ut[u(ut.length)],l=`${o} ${s}`,r=it(3),f=ht[u(ht.length)],m=pt[u(pt.length)][u(2)],T=new U(a,"witch",!1,l,[],null,u(154,16),!1,"Female",re(n,i),null,"Human",r,nt(r,2,50),null,[],f,m);return t&&F.knownWitches.set(a,T),F.witches.set(a,T),F.entities.set(a,T),T}function X(t,e,n,i){const a=z(),o=it(u(5,3)),s=e==="black"?lt()[u(lt().length)]:oe(),{value:l,color:r}=G[s],f=r[u(r.length)],m=new U(a,"cat",!1,"",[],null,u(27,1),!1,ae(),l,e==="black"?"black":f,"Feline",o,i?[]:nt(o,2,10),s);return F.entities.set(a,m),t.set(n??a,m),m}function ae(){return Math.random()<.5?"Male":"Female"}function it(t){const e=[],n=[...yt];for(let i=0;i<t;i++)e.push(...n.splice(u(n.length),1));return e}function oe(){return K[u(K.length)]}function se(t){return 1-1/(1+Math.pow(Math.E,9*(t-.65)))}function re(t,e){const n=e-t;return Math.floor(se(Math.random())*n+t)}const St=["title","content","ongoing","offer","spell"];class at{id;ongoing;nextEventDay;nextEventTick;knowns;variant;agent;title;content;offer;spell;bondrequirements;cat;triedCount;constructor(e,n,i,a,o=[],s,l,r,f,m,T,x,N){this.id=e,this.ongoing=n,this.nextEventDay=i,this.nextEventTick=a,this.knowns=[...o],this.variant=s,this.agent=l,this.title=r,this.content=f,this.offer=m,this.spell=T,this.bondrequirements=x,this.triedCount=N,this.cat=null}}const g={purchase:{noGp:"Moew No! Not enough shinies...",noSpace:"Not enough boxes, for cats to fits intos."},traps:{empty:`###################
# <Trap is Empty> #
###################`,purchaseTrap:`Purchase trap -${et.trap.value} gp`},catInteraction:{learn:"You learnt something new!",noLearn:"You learnt nothing new..."},spells:{scrying:{noLearn:"You gleam a brief view into the magnificent life of a purrcious cat, but you learn nothing new."}},time:{noTime:"No more zoomies, time for nap."}},I=C;function xt(t=1){const e=I.traps;for(let n=0;n<t;n++)e.set(`trap-${e.size}`,null)}function le(t){const e=I.traps.get(t);I.traps.set(t,null),I.catInventory.set(e.id,e)}function Ct(t){const e=I.traps;e.forEach((n,i)=>{e.get(i)||(t?Math.random()<t:Math.random()<.1)&&X(I.traps,"any",i,!0)})}function Tt(t,e){I.catCatcher.clear();const n=u(5,3);for(let i=0;i<n;i++)X(I.catCatcher,"black");for(let i=0;i<n;i++)X(I.catCatcher,"any")}function ce(){xt(),Tt()}const H=C,_=v("advance-time");function E(t=-1){return H.remainingTime<1&&t<0?(_.disabled=!0,M(g.time.noTime)):(Ct(),$e(),h(),H.remainingTime+=t),Bt(),H.remainingTime}function de(){E(H.maxTime-H.remainingTime),_.disabled&&(_.disabled=!1)}function ue(){_.onclick=()=>{E()},Bt()}const ft=C;function w(t,e,n,i,a,o){const s=z(),l=new at(s,!0,null,null,n,"notification",i,t,e,a,o,null);ft.happenings.set(s,l),ft.notifications.set(s,l),At()}const he=["variant","description"];class V{name;variant;label;description;value;target;action;constructor(e){this.name=e.name,this.variant=e.variant,this.description=e.description,this.target=e.target,this.value=e.value,this.label=e.label,this.action=e.action}}function pe(t,e,n){const i=p("button");return i.textContent=O[e].label,i.onclick=()=>{O[e].action({target:t,color:n}),h()},i}const O={scrying:new V({name:"scrying",variant:"scrying",description:"If you apply the marking to anything, you can then view it and its surroundings through the ether. You might not learn something interesting.",value:0,label:"Scry",action:t=>{E()>0?fe(t.target):M(g.time.noTime)},target:void 0}),forzachromata:new V({name:"forzachromata",variant:"colorize",description:"By weaving this spell onto any target, you change their base color to whatever you desire.",value:10,label:"Colorize",action:t=>{E()>0?(t.target.color=t.color,w(`${t.target.name} has been colorized`,`${t.target.name} looks bedazzeling with the new ${t.color} color`,[],t.target,null,null),h()):M(g.time.noTime)},target:void 0}),mutatioousia:new V({name:"mutatioousia",variant:"trait-change",description:"",value:100,label:"Change trait",action:t=>{t.target.traits.includes(t.trait)?(t.target.knownTraits.includes(t.trait)||t.target.knownTraits.push(t.trait),M(`${t.target.name} seems to already behave this way.`)):t.target.traits.length>5?M(`${t.target.name}'s little brain couldn't possibly hold any more traits`):E()>0?(t.target.traits.push(t.trait),t.target.knownTraits.push(t.trait),w(`${t.target.name}'s traits have changed`,`${t.target.name} is coming to grips with the psychological expansion of being ${t.trait}`,[],t.target,null,null),h()):M(g.time.noTime)},target:void 0})};function fe(t){if(!(.25<Math.random()))w(g.catInteraction.noLearn,g.spells.scrying.noLearn,[],t,null,null);else if(t.relationship)if(Math.random()<bt.discoverNewWitch){const n=vt();let i;S.knownWitches.has(n.id)?S.knownWitches.set(n.id,n):i=Y(n),w(g.catInteraction.learn,`You scry on ${t.name} and discover that ${t.relationship.name} is having a bewitching talk with ${n.name}.${i?`You learn something new about ${n.name}`:""}`,[],t,null,null)}else{const n=Y(t.relationship);n?w(g.catInteraction.learn,`You learned that ${t.relationship.name} is ${n}`,[],t,null,null):w(g.catInteraction.noLearn,g.spells.scrying.noLearn,[],t,null,null)}else{const n=Y(t);n?w(g.catInteraction.learn,`You learned that ${t.name} is ${n}`,[],t,null,null):w(g.catInteraction.noLearn,g.spells.scrying.noLearn,[],t,null,null)}}function ge(){const t=Object.keys(O).filter(e=>!S.spells.has(e)).filter(e=>O[e].value<=S.renown);return t.length<1?null:t[u(t.length)]}const d=C,me=v("menu");zt.onclick=()=>{k.close()};const Mt="background-color:mediumslateblue;color:white;border:2px solid lightslategrey;padding:16px",be=me.children;function ye(){const[t,e,n,i,a,o]=Array.from(be);t.onclick=()=>{d.currentScreen="catInventory",h()},n.onclick=()=>{d.currentScreen="knownWitches",h()},e.onclick=()=>{d.currentScreen="bondings",h()},a.onclick=()=>{d.currentScreen="news",h()},o.onclick=()=>{d.currentScreen="catAcquisition",h()},i.onclick=()=>{d.currentScreen="spells",h()}}const ve=v("time");function Bt(){const t=[];for(let e=0;e<d.maxTime;e++){const n=p("div");n.className=`time ${e<d.remainingTime?"remain":"used"}`,t.push(n)}y(ve,t)}function we(t){const e=p("notification-card");return e.setAttribute("title",t.title),e.setAttribute("ongoing",t.ongoing.toString()),e.setAttribute("agent",`From: ${t.agent.name}`),e.setAttribute("title",t.title),e.setAttribute("active",t.ongoing.toString()),e.setAttribute("agent",`From: ${t.agent.name}`),e.setClickable(()=>{const n=p("happening-card");St.filter(a=>typeof t[a]=="string"||typeof t[a]=="number").forEach(a=>{n.setAttribute(a.toLowerCase(),t[a])}),n.setAttribute("agent",t.agent.name),y(tt,[n]),k.showModal(),t.ongoing=!1,At()}),e}function Z(t){d.gp+=t,v("gp").textContent=`Gold: ${d.gp}`}function At(){const t=v("notifications"),e=Array.from(d.notifications.values()),n=[],i=[];e.reverse().forEach(o=>{o.ongoing?n.push(o):i.push(o)});const a=[...n,...i].map(o=>we(o));y(t,a)}function h(){const t=d.currentScreen;switch(t){case"catInventory":y(L,W(A(t),q,Be,void 0,void 0,Ae));break;case"knownWitches":y(L,W(A(t),q,Re,"Offer bonding"));break;case"bondings":y(L,gt(A(t)));break;case"news":y(L,gt(A(t)));break;case"catAcquisition":y(L,xe());break;case"spells":y(L,ke());break}Ee(),Z(0)}function ke(){return A("spells").map(n=>Se(n))}function Se(t){const e=p("spell-card"),n={...t};return he.forEach(i=>{e.setAttribute(i,n[i])}),n.variant==="scrying"&&e.setApplyButton(()=>{k.showModal(),y(v("dialog-content"),W(A("catInventory").filter(i=>!i.inbonding&&!i.relationship),q,void 0,void 0,i=>{E()>0&&(i.effectingspells.push(t.name),k.close(),h())}))}),n.variant==="colorize"&&e.setColorButtons(Ot,i=>{k.showModal(),y(v("dialog-content"),W(A("catInventory").filter(a=>!a.inbonding&&!a.relationship),q,void 0,void 0,a=>{E()>0&&(n.action({color:i,target:a}),k.close(),h())}))}),n.variant==="trait-change"&&e.setTraitButtons(yt,i=>{k.showModal(),y(v("dialog-content"),W(A("catInventory").filter(a=>!a.inbonding&&!a.relationship),q,void 0,void 0,a=>{E()>0&&(n.action({trait:i,target:a}),h())}))}),e}function xe(){const t=p("cat-acquisition");switch(t.setCatcherBtn(()=>{d.selectedAcqusition="catCatcher",h()}),t.setTrapsBtn(()=>{d.selectedAcqusition="traps",h()}),d.selectedAcqusition){case"traps":t.setAcquisitionType(Me(d.traps));break;case"catCatcher":t.setAcquisitionType(W(A("catCatcher"),ee,e=>{e.value&&d.gp<e.value?M(g.purchase.noGp):d.catInventory.size>=d.maxCatInventorySize?M(g.purchase.noSpace):$t(e,()=>{d.catCatcher.delete(e.id),d.catInventory.set(e.id,e),e.value&&Z(-e.value),h()})},"Purchase"));break}return[t]}function gt(t){return t.map(n=>Ce(n))}function Ce(t){const e=p("happening-card"),{knowns:n,agent:i,variant:a}={...t};if([...St,...n].forEach(o=>{t[o]&&e.setAttribute(o,t[o])}),i&&e.setAttribute("agent",`${i.name}`),a==="bonding"&&Te(t,e),t.variant==="news"){const o=ne(t);o&&e.setInterestingButton(()=>{t.agent.knowns.push(...o.filter(s=>s!=="traits")),t.agent.knownTraits=t.agent.traits,d.knownWitches.has(i.id)||d.knownWitches.set(i.id,i),h()})}return e}function Te(t,e){const{content:n,bondrequirements:i,cat:a}={...t};n&&e.setAttribute("content",` Needs to be: ${i.traits.join(", ")} and it would be wicked if it was a ${i.variant}`),a&&e.setAttribute("cat",a.name),t.ongoing||(e.setAttribute("variant","bonding"),e.setDivClick(()=>{d.selectedBonding=t,y(v("dialog-content"),W(A("catInventory").filter(o=>!o.inbonding&&!o.relationship),q,void 0,void 0,o=>{const s=d.selectedBonding,l=s.cat;l&&(l.inbonding=!1),s.cat=o,s.cat.inbonding=!0,k.close(),h()})),k.showModal()}),a&&(e.setAttribute("clear","block"),e.setClearCat(()=>{t.cat&&(t.cat.inbonding=!1,d.catInventory.set(t.cat.id,t.cat)),t.cat=null,h()}),e.setSendBonding(()=>{if(t.cat.color!=="black"){const o=t.cat,s=t.agent;d.catInventory.delete(o.id),o.inbonding=!1,o.relationship=null,t.cat.deceased=!0,t.cat=null,w("Bonding failed!",`"What is this vermin? It's NOT BLACK!" ${s.name} hollers and proceeds to wave her spell slinging arm at ${o.name} who disapear in a puff of smoke.`,[],t.agent,null,null),J(-20,1)}else E(),Ie(t);h()})))}function Me(t){const e=[];t.forEach((i,a)=>{if(i)e.push(Et(i.name,i.type,te,i,o=>{d.catInventory.size>=d.maxCatInventorySize?M(g.purchase.noSpace):$t(i,()=>{le(a),h()})},"Acquire",void 0,()=>{t.delete(a),h()}));else{const o=p("pre");o.textContent=g.traps.empty,o.style="border:2px solid grey;background:AliceBlue;padding:8px;margin:0;",e.push(o)}});const n=p("button");return n.innerText=g.traps.purchaseTrap,n.onclick=()=>{d.gp<et.trap.value?M(g.purchase.noGp):(xt(),Z(-100),h())},[...e,n]}function W(t,e,n,i,a,o){return t.map(l=>{const{name:r,type:f}={...l};return Et(r,f,e,l,n,i,a,o)})}function Et(t,e,n,i,a,o,s,l){const r=p("creature-card"),f={...i};n.forEach(x=>r.setAttribute(x,f[x]));const m=[...i.knownTraits,...i.knowns.map(x=>f[x])];if(r.setAttribute("description",`What you know about ${t}: ${m.join(", ")}`),r.setAttribute("image",e==="witch"?Yt:jt),a&&(e==="cat"&&(r.setAttribute("showcatslot","true"),r.setInteractClick(()=>a(i),o)),e==="witch")){const x=B(d.renown),N=B(i.value);x>=N&&(r.setAttribute("showcatslot","true"),r.setInteractClick(()=>a(i),o))}s&&r.setDivClick(()=>s(i)),l&&r.setReleaseButton(()=>l(i)),i.relationship&&r.setRelationship(i);const T=i.effectingspells;if(T&&d.currentScreen==="catInventory"){const x=T.map(N=>pe(i,N));r.setActivateSpells(x)}return r}function Be(t){if(E()>0){const e=Y(t);e?w(g.catInteraction.learn,`You managed to learn that ${t.name} is ${e}`,[],t,null,null):w(g.catInteraction.noLearn,`There doesn't seem to be anything left to learn about ${t.name}.`,[],t,null,null)}h()}function Ae(t){d.catInventory.delete(t.id),h()}function M(t){k.close();const e=p("p");e.textContent=t,e.style=Mt,y(tt,[e]),k.showModal()}function $t(t,e){let n="";const i=p("button");i.textContent="Welcome home purrrcious",i.disabled=!0,i.onclick=()=>{t.name=n,e(),k.close()};const a="cat-name-field",o=p("input");o.oninput=r=>{n=r.target.value,n!==""&&(i.disabled=!1)},o.id=a;const s=p("label");s.htmlFor=a,s.textContent="Name your new cat ",k.showModal();const l=p("div");Kt(l,[s,o,i]),l.style=Mt+"display:flex;flex-direction:column;",y(tt,[l])}function Ee(){const t=v("cat-space");t.textContent=`${d.catInventory.size}/${d.maxCatInventorySize}`}const b=C;function ot(t){const e=z(),n=t??Ut();n.inbonding=!0;const{days:i,ticks:a}=wt(u(112,72)),o=Gt[B(n.value)],s=n.traits[u(n.traits.length)];n.knownTraits.includes(s)||n.knownTraits.push(s);const l=Math.random()<bt.getSpellFromBonding?ge():null,r=l?null:Math.floor(et.bonding.value*_t(o.max,o.min)),f=Pt("black"),m=new at(e,!1,b.day+i,a,["offer"],"bonding",n,"I could try out one of your BLACK CATs",mt[u(mt.length)],r,l,{traits:[s],variant:f[u(f.length)]},1);b.knownWitches.set(n.id,n),b.bondings.set(e,m),b.happenings.set(e,m)}function $e(){b.bondings.forEach(t=>{const e=t.ongoing;if(!e&&t.nextEventDay<b.day&&(b.expiredBondings.set(t.id,t),b.bondings.delete(t.id),t.agent.inbonding=!1),e&&t.nextEventDay===b.day){const n=t.cat,i=t.agent;let a=0;n.traits.forEach(r=>{i.traits.includes(r)&&a++});const o=t.offer??0,s=a===n.traits.length?Math.ceil(o+o*a/i.traits.length+(n.variant===t.bondrequirements?.variant?o*.25:0)):o,l=t.spell;if(a<1){b.catInventory.set(n.id,n),n.inbonding=!1,t.agent.inbonding=!1,n.relationship=null,t.agent.relationship=null;const r=i.traits.filter(m=>!i.knownTraits.includes(m)),f=r[u(r.length)];t.triedCount>2?(J(st.bonding.maxFailedRenown,rt[B(t.agent.value)].min),b.completedBondings.set(t.id,t),b.bondings.delete(t.id)):(t.ongoing=!1,t.cat=null,t.bondrequirements.traits.push(f),t.nextEventDay=b.day+u(5,7)),w("Bonding Failed!",`Unfortuantely ${n.name} and ${t.agent.name} did not get along. ${n.name} returned to you slightly miffed.${r.length>0?` It seems${i.name} would preffer a familiar that is a bit more: ${f}`:""}`,[],n,0,null)}else b.completedBondings.set(t.id,t),b.bondings.delete(t.id),Z(s),n.inbonding=!1,t.agent.inbonding=!1,J(st.bonding.maxRenown,rt[B(t.agent.value)].max),l&&b.spells.set(l,O[l]),w("Bonding Succeeded!",`${n.name} and ${t.agent.name} bonded successfully. ${n.name} will now be a beloved familiar.`,[],n,o,l)}})}function Ie(t){t.ongoing=!0,t.agent.inbonding=!0,t.cat.relationship=t.agent,t.agent.relationship=t.cat;const{days:e,ticks:n}=wt(u(112,72));t.nextEventDay+=e,t.nextEventTick+=n}const mt=["Where can I find it?","I'm looking to buy it.","Need a new kitty."];function Re(t){let e="",n="";t.relationship?(e=`Bonding offer to ${t.name} rejected.`,n="Begon you pixie! I already have a beloved familiar",t.knowns.includes("relationship")||t.knowns.push("relationship")):t.inbonding?(e=`Bonding offer to ${t.name} rejected.`,n="I'm already in a process you numpty!"):B(t.value)>B(b.renown)?(e=`Bonding offer to ${t.name} rejected.`,n="You are rather beneath me."):(e=`Bonding offer to ${t.name} accepted.`,n="What an interesting proposition. What is the catch?",ot(t)),w(e,n,[],t,null,null)}const $=C;function Ne(){C.bank===null&&(C.bank=new U("666","bank",!1,"Golden Cauldron Rental & Usury",[],null,47,!1,"none",0,null,null,[],[],"bank",[],"Banker","Capitalist"))}function Fe(){let t=new Map([["newspaper",1],["cat",1],["trap",0],["rent",50]]);const{day:e,catInventory:n}=$,i=t.get("newspaper"),a=Array.from(n.values()).length,s=i+a*t.get("cat")+1*t.get("trap"),l=t.get("rent"),r=e%7===0;$.expenses+=s,r&&($.expenses+=l)}function We(){const{gp:t,expenses:e}=$;return t>=e?($.gp-=$.expenses,$.expenses=0,w("You settle your debts.","This week's expenses are paid in full!",[],$.bank,null,null),!0):(M("You ran out of money, and the bank takes everything. Game over. Game will reset in 10 seconds."),setTimeout(()=>{Object.assign($,qt),Rt(),k.close(),h()},1e4),!1)}function It(){const t=z(),e=vt(),n=new at(t,!1,null,null,["agent","patient"],"news",e,"Cat wanted for adoption!",`Long-time native ${e.name} wishes for a new companion.`,null,null,null);S.happenings.set(t,n),S.news.set(t,n)}const j=C;function De(){j.day+=1,Q&&(Q.innerText=`Day: ${j.day.toString()}`),j.day%7===0&&We(),Math.random()<.2&&It(),Math.random()<.15&&ot(),Fe(),Tt(),Ct(.25),de(),h()}function Le(){Q.innerText=`Day: ${j.day.toString()}`;const t=v("advance-day");t.onclick=De}class qe extends HTMLElement{titleSlot;contentSlot;clickableSlot;interestingButton;fromSlot;offerSlot;clearSlot;catSlot;bondingSlot;sendBondingSlot;cardSlot;constructor(){super(),this.attachShadow({mode:"open"});const e=this.shadowRoot,n=p("template");n.innerHTML='<style>h1{color:#1A4D4A;}p{color:#EFEBE0;font-size:1.2rem;}div{background-color:#6C597D;padding:8px;border-radius:6px;border:solid 8px #4F7F7D;}div:hover{background-color:#7C898D;padding:8px;border-radius:6px;border:solid 8px #4F7F7D;}div.active{background-color:#9adae6}</style><div id="card"><h1 id="title"></h1><p>From: <span id="from"></span></p><p id="content"></p><p id="offer"></p><p id="cat"></p><span id="bonding" style="display:none"><button id="clickable">Pick Cat</button><button style="display:none" id="clear-cat">Clear Cat</button><button id="send-bonding" style="display:none">Send</button></span><button id="interesting" style="display:none">Interesting...</button></div>',e.appendChild(n.content.cloneNode(!0)),this.cardSlot=c(e,"card"),this.titleSlot=c(e,"title"),this.contentSlot=c(e,"content"),this.clickableSlot=c(e,"clickable"),this.fromSlot=c(e,"from"),this.offerSlot=c(e,"offer"),this.catSlot=c(e,"cat"),this.clearSlot=c(e,"clear-cat"),this.bondingSlot=c(e,"bonding"),this.sendBondingSlot=c(e,"send-bonding"),this.interestingButton=c(e,"interesting")}static get observedAttributes(){return["title","variant","content","agent","offer","cat","clear","active","spell"]}setInterestingButton(e){this.interestingButton.onclick=e,this.interestingButton.style="display: block;"}setDivClick(e){this.clickableSlot.onclick=e}setClearCat(e){this.clearSlot.onclick=e}setSendBonding(e){this.sendBondingSlot.onclick=e}attributeChangedCallback(e,n,i){switch(e){case"title":this.titleSlot.textContent=i;break;case"content":this.contentSlot.textContent+=i;break;case"agent":this.fromSlot.textContent=i;break;case"offer":this.offerSlot.textContent=`${i} gp`;break;case"cat":this.catSlot.textContent=`Selected Cat: ${i}`,this.sendBondingSlot.style="display:block";break;case"variant":i==="bonding"&&(this.bondingSlot.style="display:block");break;case"clear":this.clearSlot.style=`display:${i}`;break;case"active":this.cardSlot.className+=i==="true"?"active":"";break;case"spell":this.offerSlot.textContent=`A certain spell called "${i}"`}}}class ze extends HTMLElement{titleSlot;pictureSlot;descriptionSlot;cardSlot;bondingSlot;catSlot;interactButton;releaseButton;relationshipSlot;spellListSlot;spellSlot;activateSpellsSlot;constructor(){super(),this.attachShadow({mode:"open"});const e=this.shadowRoot,n=p("template");n.innerHTML=`<style>#card{background-color:#1a122f;border:1px solid #4a3b6b;border-radius:8px;padding:16px;color:#e0d8f1;font-family:'Times New Roman',serif;margin:8px;display:flex;flex-direction:column;}#card:hover{background-color:#2a223f}h3 {margin-top:0;color:#b8a9d9;}p{margin:8px 0;}#traits{font-style:italic;color:#c8b9e8;}#pps {width:50px;height:50px;border-radius:4px;background-color:#EEE;border:2px solid #333;box-shadow:0 2px 4px rgba(0, 0, 0, 0.3);background-size:cover;background-position:center;display:inline-block;}#content{display:flex;gap:8px;}#content-text{display:block;}</style><div id="card"><h3 id="title"></h3><div id="content"><div id="pps"></div><div id="content-text"><p id="spell" style="display:none;">Active spells: <span id="s-l"></span></p><p id="description"></p></div></div><div id="relationship" style="display:none;"></div><div id="bonding" style="display:none;"><button>Test</button></div><div id="cat" style="display:none"><button id="interact">Interact With Cat</button><button id="release" style="display:none;">Release</button></div><div id="a-s"></div></div>`,e.appendChild(n.content.cloneNode(!0)),this.cardSlot=c(e,"card"),this.titleSlot=c(e,"title"),this.pictureSlot=c(e,"pps"),this.descriptionSlot=c(e,"description"),this.bondingSlot=c(e,"bonding"),this.catSlot=c(e,"cat"),this.interactButton=c(e,"interact"),this.releaseButton=c(e,"release"),this.relationshipSlot=c(e,"relationship"),this.spellSlot=c(e,"spell"),this.spellListSlot=c(e,"s-l"),this.activateSpellsSlot=c(e,"a-s")}setDivClick(e){this.cardSlot.onclick=e}setInteractClick(e=null,n){n&&(this.interactButton.textContent=n),this.interactButton.onclick=e}setReleaseButton(e){e&&(this.releaseButton.style.display="block"),this.releaseButton.onclick=e}setRelationship(e){this.relationshipSlot.style="display:block;",this.relationshipSlot.textContent=`${e.type==="cat"?"Familiar of":"Companion of"} ${e.relationship.name}`}setActivateSpells(e){y(this.activateSpellsSlot,e)}static get observedAttributes(){return["name","variant","description","image","inbonding","showcatslot","effectingspells"]}attributeChangedCallback(e,n,i){switch(e){case"name":this.titleSlot.textContent=i;break;case"variant":this.titleSlot.textContent=`${this.titleSlot.textContent} (${i})`;break;case"image":this.pictureSlot.innerHTML=i;break;case"description":this.descriptionSlot.textContent=i;break;case"inbonding":i==="true"&&(this.titleSlot.textContent+=" - in bonding",this.bondingSlot.style="display:block");break;case"showcatslot":this.catSlot.style="display:block";break;case"effectingspells":i!==""&&(this.spellSlot.style="display:block;"),this.spellListSlot.textContent=i;break}}}class He extends HTMLElement{titleSlot;clickable;fromSlot;constructor(){super(),this.attachShadow({mode:"open"});const e=this.shadowRoot,n=p("template");n.innerHTML=`
<style>#clickable {display: flex;flex-direction: column;justify-content: center;align-items: center;background: white;}#clickable:hover {background: #ADD8E6;}#clickable #inActive {background-color: gray;}</style><div id="clickable"><div id="from"></div><div id="title"></div></div>`,e.appendChild(n.content.cloneNode(!0)),this.clickable=c(e,"clickable"),this.titleSlot=c(e,"title"),this.fromSlot=c(e,"from")}static get observedAttributes(){return["title","active","agent"]}setClickable(e){this.clickable.onclick=e}attributeChangedCallback(e,n,i){switch(e){case"title":this.titleSlot.textContent=i;break;case"active":this.clickable.className=i==="false"?"inactive":"active";break;case"agent":this.fromSlot.textContent=i;break}}}class Ge extends HTMLElement{cardSlot;ccbtn;cgbtn;aqcSlot;constructor(){super(),this.attachShadow({mode:"open"});const e=this.shadowRoot,n=p("template");n.innerHTML=`<style>#card{background-color: #6C597D;padding:8px;border-radius:6px;border: solid 8px #4F7F7D;height:80vh;}#aqc-slot {display:flex;flex-direction:column;height:70vh;overflow: auto;gap: 4px;margin-top:8px;}.btn-container{display:flex;justify-content:space-evenly;}</style><div id="card"><h2>Get Your Cats here!</h2><div class=btn-container><button id= "cc">Cat Catcher</button><button id="cg">Traps</button></div><div id="aqc"></div></div>`,e.appendChild(n.content.cloneNode(!0)),this.cardSlot=c(e,"card"),this.ccbtn=c(e,"cc"),this.cgbtn=c(e,"cg"),this.aqcSlot=c(e,"aqc")}setCatcherBtn(e){this.ccbtn.onclick=e}setTrapsBtn(e){this.cgbtn.onclick=e}setAcquisitionType(e){y(this.aqcSlot,e)}static get observedAttributes(){return["title"]}attributeChangedCallback(e,n,i){switch(e){case"title":this.cardSlot.textContent=i;break}}}class Oe extends HTMLElement{descriptionSlot;variantSlot;cardSlot;applyBtn;btnSlot;constructor(){super(),this.attachShadow({mode:"open"});const e=this.shadowRoot,n=p("template");n.innerHTML=`<style>#card{background-color: #6C597D;padding:8px;border-radius:6px;border: solid 8px #4F7F7D;color: white;}</style><div id="card"><h2 id="variant"></h2><p id="description"></p><div id="btn"><button id="apply" style="display:none;">Apply to Cat</button></div></div>`,e.appendChild(n.content.cloneNode(!0)),this.cardSlot=c(e,"card"),this.variantSlot=c(e,"variant"),this.descriptionSlot=c(e,"description"),this.applyBtn=c(e,"apply"),this.btnSlot=c(e,"btn")}static get observedAttributes(){return["variant","description"]}setApplyButton(e){this.applyBtn.style="display:block;",this.applyBtn.onclick=e}setColorButtons(e,n){e.forEach(i=>{const a=p("button");a.id=i,a.textContent=i,a.onclick=()=>n(i),this.btnSlot.appendChild(a)})}setTraitButtons(e,n){e.forEach(i=>{const a=p("button");a.id=i,a.textContent=i,a.onclick=()=>n(i),this.btnSlot.appendChild(a)})}attributeChangedCallback(e,n,i){switch(e){case"variant":this.variantSlot.textContent=i;break;case"description":this.descriptionSlot.textContent=i;break}}}function Rt(){Ye(),ce(),ye(),h(),Le(),ue(),Ne()}Pe();Rt();function Pe(){customElements.define("happening-card",qe),customElements.define("creature-card",ze),customElements.define("notification-card",He),customElements.define("cat-acquisition",Ge),customElements.define("spell-card",Oe)}function P(t,e){for(let n=0;n<(e??3);n++)t()}function Ye(){Ht.forEach(t=>{P(()=>kt(void 0,void 0,D[t].min,D[t].max),30)}),P(ie,2),P(ot,1),P(It,1)}
</script></head><style>html,body {margin: 0;padding: 0;background: radial-gradient(circle, #000 0%, #0b0038 100%);}:root {--bar-height: 3vh;--menu-width: 15vw;--notification-width: 20vw;}#app {position: relative;height: 100vh;width: 100vw;z-index: 1;}#top-bar {display: flex;flex-direction: row;justify-content: space-between;max-height: var(--bar-height);border: solid 2px black;color: white;}#content {display: grid;grid-template-columns: 1fr 3fr 1.5fr;height: calc(100% - var(--bar-height));width: 100%;}#menu {height: calc(100% - var(--bar-height));display: flex;flex-direction: column;padding: 8px 2px;gap: 4px;}#screen {overflow: scroll;padding: 16px;display: flex;flex-direction: column;gap: 4px;}#time {display: flex;flex-direction: row;justify-content: space-evenly;align-items: center;width: 30vw;}.time {border-radius: 50%;width: 8px;height: 8px;}.time.remain {background-color: blueviolet;}.time.used {background-color: lightgrey;}#dialog {max-height: 70vh;max-width: 70vw;background-color: transparent;border: none;}#notifications-wrapper {display: flex;flex-direction: column;justify-content: center;align-items: center;padding: 8px;}#notifications-background {display: flex;flex-direction: column;align-items: center;height: 60vh;width: 100%;border-radius: 8px;background-color: Midnightblue;}#notifications {display: flex;flex-direction: column;gap: 4px;width: 95%;height: 100%;border-radius: 8px;overflow: auto;opacity: 0.8;}button {border: 4px solid Indigo;background-color: slateblue;color: white;}button:disabled {background-color: grey;color: black;border-color: darkgrey;}#backgroundtext {position: fixed;bottom: 50%;right: 50%;transform: translateX(50%);z-index: 0;overflow: hidden;white-space: nowrap;-webkit-text-stroke: 2px white;font-size: 70px;}#notification-title {color: mintcream;}</style><body><h1 id="backgroundtext">BLACK HAT'S BLACK CATS</h1><dialog id="dialog"><button id="close-dialog">X</button><div id="dialog-content"></div></dialog><div id="app"><div id="top-bar"><div id="time"></div><div id="day">0</div><div id="gp">Gold: 0</div><div><span>Cat space: </span><span id="cat-space">0/10</span></div><div><button id="advance-day">Next Day</button><button id="advance-time">Hour Tick</button></div></div><div id="content"><div id="menu"><button id="m-catInventory">Cats</button><button id="m-bondings">Bondings</button><button id="m-knownWitches">Witches</button><button id="m-spells">Spells</button><button id="m-news">Wiccan Times</button><button id="m-catAcquisition">Cat Acquisition</button></div><div id="screen"></div><div id="notifications-wrapper"><div id="notifications-background"><h3 id="notification-title">Notifications</h3><div id="notifications"></div></div></div></div></div></body></html>